{"version":3,"file":"locator.js","sources":["../../../../utils/src/locator.ts"],"sourcesContent":["/**\n * Null-safe navigation through object properties, that allows to generate missing properties on the fly.\n *\n * @public\n */\nexport class Locator<U> {\n    constructor(private _obj: U, private _parent?: Locator<any>, private _parentKey?: string | number | symbol) {}\n\n    /**\n     * Descend to the given property of the object.\n     * @param propertyName - the property to access to.\n     */\n    at<K extends keyof U>(propertyName: K): Locator<U[K]> {\n        return new Locator(this._obj ? this._obj[propertyName] : undefined, this, propertyName);\n    }\n\n    /**\n     * Get the property value\n     * @returns the property value (can be null)\n     */\n    get(): U {\n        return this._obj;\n    }\n\n    /**\n     * Get the property value, or generate a new one with the given function.\n     * The generated property is then saved into the object.\n     * @param valueProvider - the function used to generate a new value\n     * @returns the property value\n     */\n    orElseCompute(valueProvider: () => U): U {\n        return this.orElse(valueProvider, true);\n    }\n\n    /**\n     * Get the property value, or generate a new one with the given function.\n     * The generated property is **not** saved into the object.\n     * @param valueProvider - the function used to generate a new value\n     * @returns the property value\n     */\n    orElseGet(valueProvider: () => U): U {\n        return this.orElse(valueProvider, false);\n    }\n\n    /**\n     * Get the property value, or generate a new one with the given function.\n     * @param valueProvider - the function used to generate a new value\n     * @param save - if the generated property should then be saved into the object.\n     * @returns the property value\n     */\n    orElse(valueProvider: () => U, save = true): U {\n        const value = this._obj ?? valueProvider();\n        if (save) {\n            this._obj = value;\n            this._parent._patch(value, this._parentKey);\n        }\n        return value;\n    }\n\n    private _patch<K extends keyof U>(value: U[K], key: K) {\n        if (!this._obj) {\n            this._obj = {} as U;\n            if (this._parent) {\n                this._parent._patch(this._obj, this._parentKey);\n            }\n        }\n        this._obj[key] = value;\n    }\n}\n\n/**\n * @param obj - the object to navigate through.\n *\n * @public\n */\nexport function locator<U = unknown>(obj: U) {\n    return new Locator(obj);\n}\n"],"names":[],"mappings":"AAAA;;;;;MAKa,OAAO;IAChB,YAAoB,IAAO,EAAU,OAAsB,EAAU,UAAqC;QAAtF,SAAI,GAAJ,IAAI,CAAG;QAAU,YAAO,GAAP,OAAO,CAAe;QAAU,eAAU,GAAV,UAAU,CAA2B;KAAI;;;;;IAM9G,EAAE,CAAoB,YAAe;QACjC,OAAO,IAAI,OAAO,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,SAAS,EAAE,IAAI,EAAE,YAAY,CAAC,CAAC;KAC3F;;;;;IAMD,GAAG;QACC,OAAO,IAAI,CAAC,IAAI,CAAC;KACpB;;;;;;;IAQD,aAAa,CAAC,aAAsB;QAChC,OAAO,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;KAC3C;;;;;;;IAQD,SAAS,CAAC,aAAsB;QAC5B,OAAO,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;KAC5C;;;;;;;IAQD,MAAM,CAAC,aAAsB,EAAE,IAAI,GAAG,IAAI;;QACtC,MAAM,KAAK,SAAG,IAAI,CAAC,IAAI,mCAAI,aAAa,EAAE,CAAC;QAC3C,IAAI,IAAI,EAAE;YACN,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;YAClB,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;SAC/C;QACD,OAAO,KAAK,CAAC;KAChB;IAEO,MAAM,CAAoB,KAAW,EAAE,GAAM;QACjD,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;YACZ,IAAI,CAAC,IAAI,GAAG,EAAO,CAAC;YACpB,IAAI,IAAI,CAAC,OAAO,EAAE;gBACd,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;aACnD;SACJ;QACD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;KAC1B;CACJ;AAED;;;;;SAKgB,OAAO,CAAc,GAAM;IACvC,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,CAAC;AAC5B;;;;"}