{"version":3,"file":"utils.js","sources":["../../../../src/weaver/utils.ts"],"sourcesContent":["import { assert } from '@aspectjs/core/utils';\n\n/**\n *\n * @param fn\n * @param name\n * @param tag\n * @param toString\n * @internal\n */\nexport function _defineFunctionProperties<T, F extends (...args: any[]) => T>(\n    fn: F,\n    name: string,\n    tag: string,\n    toString: () => string,\n): F {\n    assert(typeof fn === 'function');\n\n    // const newFn = fn;\n    const newFn = new Function('fn', `return function ${name}(...args) { return fn.apply(this, args) };`)(fn);\n    Object.defineProperty(newFn, 'name', {\n        value: name,\n    });\n    tag = tag ?? name;\n\n    Object.defineProperty(newFn, Symbol.toPrimitive, {\n        enumerable: false,\n        configurable: true,\n        value: () => tag,\n    });\n\n    newFn.prototype.toString = toString;\n    newFn.toString = toString;\n    return newFn;\n}\n"],"names":[],"mappings":";;AAEA;;;;;;;;SAQgB,yBAAyB,CACrC,EAAK,EACL,IAAY,EACZ,GAAW,EACX,QAAsB;IAEtB,MAAM,CAAC,OAAO,EAAE,KAAK,UAAU,CAAC,CAAC;;IAGjC,MAAM,KAAK,GAAG,IAAI,QAAQ,CAAC,IAAI,EAAE,mBAAmB,IAAI,4CAA4C,CAAC,CAAC,EAAE,CAAC,CAAC;IAC1G,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,MAAM,EAAE;QACjC,KAAK,EAAE,IAAI;KACd,CAAC,CAAC;IACH,GAAG,GAAG,GAAG,aAAH,GAAG,cAAH,GAAG,GAAI,IAAI,CAAC;IAElB,MAAM,CAAC,cAAc,CAAC,KAAK,EAAE,MAAM,CAAC,WAAW,EAAE;QAC7C,UAAU,EAAE,KAAK;QACjB,YAAY,EAAE,IAAI;QAClB,KAAK,EAAE,MAAM,GAAG;KACnB,CAAC,CAAC;IAEH,KAAK,CAAC,SAAS,CAAC,QAAQ,GAAG,QAAQ,CAAC;IACpC,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;IAC1B,OAAO,KAAK,CAAC;AACjB;;;;"}