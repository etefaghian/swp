{"version":3,"file":"weaver-context.impl.js","sources":["../../../../src/weaver/weaver-context.impl.ts"],"sourcesContent":["import {\n    AnnotationBundleRegistry,\n    AnnotationLocationFactory,\n    AnnotationRegistry,\n    AnnotationTargetFactory,\n    AspectsRegistry,\n    RootAnnotationsBundle,\n    Weaver,\n    WeaverContext,\n} from '@aspectjs/core/commons';\nimport { AspectsRegistryImpl } from '../aspect/aspect.registry.impl';\nimport { JitWeaver } from './jit/jit-weaver';\n\nconst bundleRegistry: AnnotationBundleRegistry = {\n    byTargetClassRef: {},\n    byAnnotation: {},\n};\n\nconst bundle = new RootAnnotationsBundle(bundleRegistry);\nconst annotationRegistry = new AnnotationRegistry(bundleRegistry);\n/**\n * @public\n */\nexport class WeaverContextImpl implements WeaverContext {\n    readonly weaver: Weaver;\n    private readonly _targetFactory = new AnnotationTargetFactory();\n\n    readonly aspects: { registry: AspectsRegistry };\n\n    readonly annotations = {\n        location: new AnnotationLocationFactory(this._targetFactory),\n        registry: annotationRegistry,\n        targetFactory: this._targetFactory,\n        bundle,\n    };\n\n    constructor() {\n        this.aspects = {\n            registry: new AspectsRegistryImpl(this),\n        };\n\n        this.weaver = this._createWeaver();\n    }\n\n    protected _createWeaver(): Weaver {\n        return new JitWeaver(this);\n    }\n    /**\n     * Get the global weaver\n     */\n    getWeaver(): Weaver {\n        return this.weaver;\n    }\n}\n"],"names":[],"mappings":";;;;AAaA,MAAM,cAAc,GAA6B;IAC7C,gBAAgB,EAAE,EAAE;IACpB,YAAY,EAAE,EAAE;CACnB,CAAC;AAEF,MAAM,MAAM,GAAG,IAAI,qBAAqB,CAAC,cAAc,CAAC,CAAC;AACzD,MAAM,kBAAkB,GAAG,IAAI,kBAAkB,CAAC,cAAc,CAAC,CAAC;AAClE;;;MAGa,iBAAiB;IAa1B;QAXiB,mBAAc,GAAG,IAAI,uBAAuB,EAAE,CAAC;QAIvD,gBAAW,GAAG;YACnB,QAAQ,EAAE,IAAI,yBAAyB,CAAC,IAAI,CAAC,cAAc,CAAC;YAC5D,QAAQ,EAAE,kBAAkB;YAC5B,aAAa,EAAE,IAAI,CAAC,cAAc;YAClC,MAAM;SACT,CAAC;QAGE,IAAI,CAAC,OAAO,GAAG;YACX,QAAQ,EAAE,IAAI,mBAAmB,CAAC,IAAI,CAAC;SAC1C,CAAC;QAEF,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;KACtC;IAES,aAAa;QACnB,OAAO,IAAI,SAAS,CAAC,IAAI,CAAC,CAAC;KAC9B;;;;IAID,SAAS;QACL,OAAO,IAAI,CAAC,MAAM,CAAC;KACtB;;;;;"}